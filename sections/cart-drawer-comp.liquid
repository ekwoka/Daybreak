<!-- cart-drawer-comp.liquid START -->
{{ 'cart-drawer.comp.css' | asset_url | stylesheet_tag }}
<div x-data="cart" x-effect="$store.cart.isOpen?document.body.classList.add('scroll-lock'):document.body.classList.remove('scroll-lock')">
    <div class="fixed inset-0 z-10 transition-all duration-700 ease-out transform bg-gray-900/60 md:bg-gray-900/90 backdrop-blur overscroll-contain md:backdrop-blur-[2px]" @click="$store.cart.isOpen = false" x-show="$store.cart.isOpen" x-cloak style="display: none"
        x-transition:enter-start="translate-y-full"
        x-transition:leave-end="translate-y-full"> </div>
    <div class="fixed inset-y-0 right-0 z-10 flex flex-col w-full transition-all duration-700 ease-out transform bg-white border border-gray-500 shadow-md xs:w-11/12 sm:w-5/6 overscroll-contain md:max-w-screen-sm" x-show="$store.cart.isOpen" x-cloak style="display: none"
    x-transition:enter-start="translate-x-full"
    x-transition:leave-end="translate-x-full">
        <h2 class="p-2 pt-4 pl-4 text-lg">Cart</h2>
        <button class="absolute block px-4 py-2 right-2 top-2" @click="$store.cart.isOpen = false">Close<svg xmlns="http://www.w3.org/2000/svg" class="inline w-5 h-5 align-bottom" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
          </svg></button>
        <div class="flex flex-col w-full px-1 py-2 overflow-auto divide-y divide-gray-300">
            <template x-if="$store.cart.items.length == 0">
                <div class="w-full p-4 mx-auto text-center">Your cart is empty</div>
            </template>
            <template x-for="(item,index) in $store.cart.items" :key="item.id">
                <div class="flex flex-row w-full gap-2 px-1">
                    <img class="flex-none object-scale-down w-1/3" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw" x-rias="item.featured_image.url" :width="item.featured_image.width" :height="item.featured_image.height" :alt="item.featured_image.alt" data-sizes="auto" loading="lazy"/>
                    <div class="flex flex-col flex-auto">
                        <a :href="item.url" x-text="item.product_title"></a>
                        <div class="block text-gray-700" x-text="item.variant_title"></div>

                        <div class="flex flex-row flex-none w-24 mt-4 max-w-1/2 flex-nowrap focus-within:ring-2 ring-primary-500">
                            <button @click.prevent="item.quantity--;updateCart(index,item.quantity)" :disabled="item.quantity <=0||updating" class="flex-auto w-8 h-8 border border-r-0 border-gray-400 focus:outline-none disabled:bg-gray-200">-</button>
                            <input type="text" disabled class="flex-none w-8 h-8 p-1 text-center border border-gray-400 appearance-none focus:border-gray-400" x-model="item.quantity" :aria-label="`Quantity: ${item.quantity}`" aria-label="Quantity:"/>
                            <button @click.prevent="item.quantity++;updateCart(index,item.quantity)" class="flex-auto w-8 h-8 border border-l-0 border-gray-400 appearance-none focus:outline-none disabled:bg-gray-200" :disabled="updating">+</button>
                        </div>
                        <div class="flex-auto w-full pt-2 pr-2 ml-auto text-base font-medium text-right divide-x md:pr-8 min-w-max text-cta-600">
                            <button x-show="item.quantity != 0" class="flex-none float-left pl-2 pr-2 text-red-400 underline" @click.prevent="item.quantity=0;updateCart(index,item.quantity)" :disabled="updating">remove</button>
                            <span class="pl-2" x-text="Daybreak.currency.format(item.final_price*item.quantity/100)"></span>
                            <span class="hidden pl-2" x-cloak x-text="'$19.00'" ></span>
                        </div>

                    </div>
                </div>
            </template>
        </div>
        <div class="sticky bottom-0 flex flex-col items-center w-full p-2 pb-4 mx-auto bg-white">
            <button class="w-full my-2 btn-primary" @click.prevent="window.location.href='/checkout'" :disabled="$store.cart.quantity==0||updating">
                <svg class="inline-block w-5 h-5 mr-2 text-white align-bottom animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" x-show="updating">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              <span x-text="updating?'updating...':`Checkout - ${Daybreak.currency.format($store.cart.value/100)}`" {%- if cart.item_count < 1 %} disabled {%- endif -%}>Checkout</span>
            </button>
            <div>Available at Checkout</div>
            <div class="flex">
                {%- liquid
                    for type in shop.enabled_payment_types
                        echo type | payment_type_svg_tag
                    endfor
                -%}
            </div>
        </div>
    </div>
</div>

<!-- cart-drawer-comp.liquid END -->


{% schema %}
{
    "name": "Cart Drawer",
    "tag": "aside", 
    "class": "h-0"
}
{% endschema %}