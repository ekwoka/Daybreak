<!-- cart-drawer-comp.liquid START -->
{{ 'cart-drawer.comp.css' | asset_url | stylesheet_tag }}
<div x-data="cart" x-effect="$store.cart.isOpen?document.body.classList.add('scroll-lock'):document.body.classList.remove('scroll-lock')">
    <cart-backdrop @click="$store.cart.isOpen = false" x-show="$store.cart.isOpen" x-cloak style="display: none"
        x-transition:enter-start="translate-y-full"
        x-transition:leave-end="translate-y-full"> </cart-backdrop>
    <cart-drawer x-show="$store.cart.isOpen" x-cloak style="display: none"
    x-transition:enter-start="translate-x-full"
    x-transition:leave-end="translate-x-full">
        <cart-title>Cart</cart-title>
        <button class="close-btn" @click="$store.cart.isOpen = false">Close<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
          </svg></button>
        <cart-container>
            <template x-if="$store.cart.items.length == 0">
                <cart-empty class="w-full p-4 mx-auto text-center">Your cart is empty</cart-empty>
            </template>
            <template x-for="(item,index) in $store.cart.items" :key="item.id">
                <cart-item>
                    <img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw" x-rias="item.featured_image.url" :width="item.featured_image.width" :height="item.featured_image.height" :alt="item.featured_image.alt" data-sizes="auto" loading="lazy"/>
                    <item-details>
                        <a :href="item.url" x-text="item.product_title"></a>
                        <div class="block text-gray-700" x-text="item.variant_title"></div>
                        <quantity-control>
                            <button class="border-r-0" @click.prevent="item.quantity--;updateCart(index,item.quantity)" :disabled="item.quantity <=0||updating">-</button>
                            <input type="text" disabled x-model="item.quantity" :aria-label="`Quantity: ${item.quantity}`" aria-label="Quantity:"/>
                            <button class="border-l-0" @click.prevent="item.quantity++;updateCart(index,item.quantity)" :disabled="updating">+</button>
                        </quantity-control>
                        <remove-price>
                            <button x-show="item.quantity != 0" @click.prevent="item.quantity=0;updateCart(index,item.quantity)" :disabled="updating">remove</button>
                            <old-price class="hidden" x-cloak x-text="'$19.00'" ></old-price>
                            <new-price x-text="Daybreak.currency.format(item.final_price*item.quantity/100)"></new-price>
                        </remove-price>
                    </item-details>
                </cart-item>
            </template>
        </cart-container>
        <div class="sticky bottom-0 flex flex-col items-center w-full p-2 pb-4 mx-auto bg-white">
            <button class="w-full my-2 btn-primary" @click.prevent="window.location.href='/checkout'" :disabled="$store.cart.quantity==0||updating">
                <svg class="inline-block w-5 h-5 mr-2 text-white align-bottom animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" x-show="updating">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              <span x-text="updating?'updating...':`Checkout - ${Daybreak.currency.format($store.cart.value/100)}`" {%- if cart.item_count < 1 %} disabled {%- endif -%}>Checkout</span>
            </button>
            <div>Available at Checkout</div>
            <div class="flex">
                {%- liquid
                    for type in shop.enabled_payment_types
                        echo type | payment_type_svg_tag
                    endfor
                -%}
            </div>
        </div>
    </cart-drawer>
</div>

<!-- cart-drawer-comp.liquid END -->


{% schema %}
{
    "name": "Cart Drawer",
    "tag": "aside", 
    "class": "h-0"
}
{% endschema %}